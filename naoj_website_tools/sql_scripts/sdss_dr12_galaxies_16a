SELECT
    object.ra AS hsc_ra,
    object.dec AS hsc_dec,
            object.imag_sinc AS hsc_mag,         specz.mag_i     AS specz_mag,
    match.d_pos, rank() OVER (PARTITION BY match.specz_id ORDER BY     match.d_pos ),
    match.d_mag, rank() OVER (PARTITION BY match.specz_id ORDER BY abs(match.d_mag)),
    specz.redshift,
    object.object_id,
    object.gcmodel_dev_mag,
    object.rcmodel_dev_mag,
    object.icmodel_dev_mag,
    object.zcmodel_dev_mag,
    object.ycmodel_dev_mag,
    object.tract,
    object.patch
FROM
    s16a_wide.forced AS object
    JOIN
    s16a_wide.specz AS match
        ON (object.object_id = match.object_id)
    JOIN
    external_catalog.specz_201602                  AS specz
        ON (match.specz_id = specz.id)
WHERE
    specz.redshift > 0.1 AND specz.redshift < 1.0 AND specz.flag_sdss_dr12 is true 
;
